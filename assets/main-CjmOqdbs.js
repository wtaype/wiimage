import{o as B,g as L,a as E,$ as e,s as C,b as d,r as h,c as R,d as S,e as F,f as G}from"./widev-D9cmAjox.js";import"./wiauth-DaNSepaH.js";B(G,async t=>{if(!t)return h("wiAuthIn"),h("wiAuthRol");if(d("wiAuthIn")){const a=d("wiAuthRol");if(a)return S(a);const n=await getDocs(query(collection(F,"smiles"),where("email","==",t.email)));S(n.docs[0]?.data()?.rol)}});L(".txe","id",t=>t.html());E(".txe","id",(t,a)=>t.html(a));const i=e(".txe"),K=e(".nts"),s=e(".editor .hcon");let m=0;const b=t=>+String(t).replace(/\D+/g,"")||0,T=(t,a=34)=>e("<div>").html(t||"").text().replace(/\s+/g," ").trim().slice(0,a),z=t=>(e('[data-ki^="ki"]').removeClass("activa"),e(`[data-ki="${t}"]`).addClass("activa")),$=(t,a)=>{const n=e(`[data-ki="${t}"]`);n.length?n.text(a):e(`<div class="nt nt${b(t)}" data-ki="${t}">${a}</div>`).appendTo(K)},q=t=>{const a=d(t)||"";i.attr("id",t).html(a).focus(),z(t)},H=()=>{const t=e('[data-ki^="ki"]').map((n,l)=>b(e(l).data("ki"))).get(),a=Object.keys(localStorage).filter(n=>/^ki\d+$/.test(n));m=Math.max(m,0,...t,...a.map(b)),e.each(a,(n,l)=>{const A=d(l);A&&$(l,T(A)+"...")})},D=(()=>{let t;return(a=1800)=>{const n=e(".guardar_nota");n.length&&(n.addClass("bta").text("Guardado"),clearTimeout(t),t=setTimeout(()=>{n.removeClass("bta").text("Guardar")},a))}})();i.on("input",()=>{const t=i.attr("id");if(t){C(t,i.html(),24);const a=T(d(t));a&&e(`[data-ki="${t}"]`).text(a+"..."),D()}});e(document).on("click",".guardar_nota",()=>{const t=i.attr("id");t&&(C(t,i.html(),24),D())});H();e(document).on("click",".agregar_nota",()=>{const t=`ki${++m}`;$(t,`Nota ${m}`),q(t)});e(document).on("click",'[data-ki^="ki"]',t=>q(e(t.currentTarget).data("ki")));e(document).on("click",".limpiar_nota",()=>{const t=i.attr("id");t&&(i.empty(),h(t),$(t,"Nota vacía..."),R(void 0,"bta","Eliminado","Eliminar"))});const J={".fa-bold":"bold",".fa-italic":"italic",".fa-underline":"underline",".fa-list-ul":"insertUnorderedList",".fa-list-ol":"insertOrderedList",".fa-align-left":"justifyLeft",".fa-align-center":"justifyCenter",".fa-align-right":"justifyRight",".fa-rotate-left":"undo"};e.each(J,(t,a)=>s.find(t).attr("data-cmd",a));let k=null;const x=()=>{const t=window.getSelection();if(!t||!t.rangeCount)return!1;const a=t.anchorNode;return a&&(i[0]===a||e.contains(i[0],a))},v=()=>{const t=window.getSelection();t&&t.rangeCount&&x()&&(k=t.getRangeAt(0))},P=()=>{if(!k)return;const t=window.getSelection();t.removeAllRanges(),t.addRange(k)},Q=t=>{!x()&&k&&P(),document.execCommand(t,!1,null),i.focus(),v(),p()};s.on("mousedown","i",t=>t.preventDefault()).on("click","i",function(){const t=e(this).data("cmd");t&&Q(t)});const V=[[".fa-bold","bold"],[".fa-italic","italic"],[".fa-underline","underline"],[".fa-list-ul","insertUnorderedList"],[".fa-list-ol","insertOrderedList"]],p=()=>{if(!x())return void s.find("i").removeClass("actv").addClass("is-disabled");s.find("i").removeClass("is-disabled"),e.each(V,(n,l)=>s.find(l[0]).toggleClass("actv",document.queryCommandState(l[1])));const t=document.queryCommandState("justifyCenter"),a=document.queryCommandState("justifyRight");s.find(".fa-align-center").toggleClass("actv",t),s.find(".fa-align-right").toggleClass("actv",a),s.find(".fa-align-left").toggleClass("actv",!t&&!a)};document.addEventListener("selectionchange",()=>{v(),p()});i.on("keyup mouseup input",()=>{v(),p()});v();p();const _=e(".paste"),o=e(".ibx .bx");o.each((t,a)=>e(a).attr("data-k",`im${t+1}`));const y=e(".vw"),j=e(".vw img"),r=e(".vw .th");let c=-1;const w=()=>o.map((t,a)=>e(a).attr("data-src")?t:null).get(),u=()=>{const t=w();r.empty().append(t.map(a=>`<div class="ti" data-i="${a}"><img src="${o.eq(a).attr("data-src")}"></div>`)),r.find(`[data-i="${c}"]`).addClass("on")},W=(t,a)=>{const n=o.eq(t);n.attr("data-src",a).addClass("fill").html(`<img src="${a}">`),C(n.attr("data-k"),a,720),u()},X=()=>o.toArray().findIndex(t=>!e(t).attr("data-src")),Y=t=>{let a=X();a<0&&(a=0),W(a,t)},Z=t=>{const a=new FileReader;a.onload=()=>Y(a.result),a.readAsDataURL(t)},O=t=>Array.from(t).forEach(a=>a&&/^image\//.test(a.type)&&Z(a));_.on("paste",t=>{const a=t.originalEvent.clipboardData;a&&O(Array.from(a.items).map(n=>n.getAsFile()).filter(Boolean))});_.on("dblclick",()=>{e('<input type="file" accept="image/*" multiple hidden>').appendTo("body").on("change",t=>{O(t.target.files),e(t.target).remove()}).trigger("click")});E(".ibx .bx","data-k",(t,a)=>{a&&t.attr("data-src",a).addClass("fill").html(`<img src="${a}">`)});L(".ibx .bx","data-k",t=>t.attr("data-src")||"");u();const f=t=>{const a=o.eq(t).attr("data-src");if(!a)return;c=t,j.attr("src",a),y.addClass("show"),r.find(".ti").removeClass("on"),r.find(`[data-i="${t}"]`).addClass("on");const n=r.find(`[data-i="${t}"]`);n.length&&r.animate({scrollLeft:Math.max(0,n.position().left+r.scrollLeft()-(r.width()-n.width())/2)},180)},g=()=>{y.removeClass("show"),c=-1},I=()=>{const t=w();if(!t.length)return g();f(t[(t.indexOf(c)+1)%t.length])},M=()=>{const t=w();if(!t.length)return g();f(t[(t.indexOf(c)-1+t.length)%t.length])},N=()=>{const t=e("<a>").attr({href:j.attr("src"),download:`wiimage-${c+1}.png`}).appendTo("body");t[0].click(),t.remove()},U=()=>{const t=o.eq(c);h(t.attr("data-k")),t.removeAttr("data-src").removeClass("fill").empty(),u();const a=w();a.length?f(a[0]):g()};e(document).on("click",".ibx .bx",t=>{const a=o.index(t.currentTarget);e(t.currentTarget).attr("data-src")&&f(a)});e(document).on("click",".vw .cls, .vw",t=>{(t.target===t.currentTarget||e(t.target).closest(".cls").length)&&g()});e(document).on("click",".vw .nx",I);e(document).on("click",".vw .pv",M);e(document).on("click",".vw .dl",N);e(document).on("click",".vw .rm",U);e(document).on("click",".vw .th .ti",t=>f(+e(t.currentTarget).data("i")));e(document).on("keydown",t=>{if(y.hasClass("show")){if(t.ctrlKey&&(t.key==="s"||t.key==="S"))return t.preventDefault(),N();if(t.key==="Escape")return g();if(t.key==="ArrowRight"||t.key===">"||t.key===".")return I();if(t.key==="ArrowLeft"||t.key==="<"||t.key===",")return M();if(t.key==="Delete"||t.key==="Supr"||t.key==="Backspace")return U()}});e(".bt_borrar").click(function(){if(confirm("¿Eliminar todo lo guardado?")){try{localStorage.clear()}catch{Object.keys(localStorage).forEach(a=>localStorage.removeItem(a))}e('[data-ki^="ki"]').remove(),i.removeAttr("id").empty(),m=0,o.removeAttr("data-src").removeClass("fill").empty(),u&&u(),y.removeClass("show"),c=-1,R(this,"bta","Eliminado","Eliminar")}});
